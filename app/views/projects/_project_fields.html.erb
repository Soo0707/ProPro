  <section class="project-fields">
    <header class="section-header">
      <h2 class="section-title">Project Details</h2>
    </header>
  
    <div class="fields-container">
      <% fields.each do |field| %>
        <div class="field-row">
          <div class="field-label">
            <%= field.project_template_field.label %>
          </div>
          <div class="field-value">
            <% if field.value.present? %>
              <% 
                if field.project_template_field.dropdown? || field.project_template_field.radio?
                  begin
                    parsed_value = JSON.parse(field.value)
                    display_value = parsed_value.is_a?(Array) ? parsed_value.join(", ") : parsed_value
                  rescue JSON::ParserError
                    display_value = field.value
                  end
                else
                  display_value = field.value
                end
              %>
              <%= simple_format(display_value) %>
            <% else %>
              No content provided
            <% end %>
          </div>
          <div class="field-row">
            <% topic_response = TopicResponses.find_by(project: @project) %>
            <% if topic_response %>
              <% topic_instance = ProjectInstance.find_by(id: topic_response.project_instance_id) %>
              <% topic_title = topic_instance&.title || "Own Proposal" %>
            <% else %>
              <% topic_title = "Own Proposal" %>
            <% end %>
            <p>Topic: <%= topic_title %></p>
          </div>
        </div>
      <% end %>

    </div>
  </section>